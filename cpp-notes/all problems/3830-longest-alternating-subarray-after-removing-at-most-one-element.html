<!-- all problems/3830-longest-alternating-subarray-after-removing-at-most-one-element.html: 3830. Longest Alternating Subarray After Removing At Most One Element -->
<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3830. Longest Alternating Subarray After Removing At Most One Element</title>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body class="page-article">
  <header>
    <nav class="navbar">
      <a class="brand" href="../../personal.html">scottnick å€‹äººç¶²é </a>
      <button class="menu-btn" id="menu-btn" aria-label="é–‹å•Ÿé¸å–®" aria-expanded="false">â˜°</button>
      <div class="nav-links" id="nav-links">
        <a href="../../index.html">ä¸»é </a>
        <a href="../../courses.html">ä¿®èª²ç´€éŒ„</a>
        <a href="../../cpp.html" class="active">C++å­¸ç¿’ç­†è¨˜</a>
        <a href="../../profile.html">å€‹äººæª”æ¡ˆ</a>
      </div>
      <div class="nav-actions">
        <a class="nav-action-link" href="../../categories.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
               width="18" height="18" aria-hidden="true" focusable="false"
               style="display:inline-block; vertical-align:-3px; margin-right:6px;">
            <rect x="4" y="4" width="7" height="7" rx="1.2" fill="none" stroke="currentColor" stroke-width="1.8"></rect>
            <rect x="13" y="4" width="7" height="7" rx="1.2" fill="none" stroke="currentColor" stroke-width="1.8"></rect>
            <rect x="4" y="13" width="7" height="7" rx="1.2" fill="none" stroke="currentColor" stroke-width="1.8"></rect>
            <rect x="13" y="13" width="7" height="7" rx="1.2" fill="none" stroke="currentColor" stroke-width="1.8"></rect>
          </svg>
          é¡åˆ¥
        </a>
        <button class="icon-btn toggle-btn" id="theme-toggle" aria-label="åˆ‡æ›ä¸»é¡Œ">
          <span id="theme-icon" aria-hidden="true">â˜€ï¸</span>
        </button>
      </div>
    </nav>
  </header>

  <main>
    <nav class="breadcrumb" aria-label="æ–‡ç« è·¯å¾‘">
      <a href="../../cpp.html">C++å­¸ç¿’ç­†è¨˜</a>
      <span aria-hidden="true">/</span>
      <a href="index.html">All problems</a>
      <span aria-hidden="true">/</span>
      <span>3830. Longest Alternating Subarray After Removing At Most One Element</span>
    </nav>

    <section class="hero">
      <h1>3830. Longest Alternating Subarray After Removing At Most One Element</h1>
      <p><strong>ç·´ç¿’æ—¥æœŸï¼š</strong>2026-02-01</p>
      <p><strong>é›£åº¦ï¼š</strong>Hard</p>
      <p><strong>é¡å‹ï¼š</strong>Weekly Contest 487</p>
    </section>

    <div class="article-layout">
      <aside class="article-toc" aria-label="æ–‡ç« ç›®éŒ„">
        <button class="toc-toggle" id="article-toc-toggle" type="button" aria-expanded="false">
          ç›®éŒ„
        </button>
        <strong>ç›®éŒ„</strong>
        <ul>
          <li><a href="#statement">ğŸ“˜ é¡Œç›®æ•˜è¿°</a></li>
          <li><a href="#approach">ğŸ§  è§£é¡Œæ€è·¯</a></li>
          <li><a href="#steps">ğŸªœ ä¸»è¦æµç¨‹æ­¥é©Ÿ</a></li>
          <li><a href="#code">ğŸ’» ç¨‹å¼ç¢¼å¯¦ä½œ</a></li>
          <li><a href="#link">ğŸ”— é¡Œç›®é€£çµ</a></li>
        </ul>
      </aside>

      <section class="term-block article-content">
        <h2 id="statement">ğŸ“˜ é¡Œç›®æ•˜è¿°</h2>
        <p>ä½ æœƒå¾—åˆ°ä¸€å€‹æ•´æ•¸é™£åˆ— <code>nums</code>ã€‚</p>
        <p>è«‹åœ¨å‡½å¼ä¸­å»ºç«‹ä¸€å€‹è®Šæ•¸åç¨±ç‚º <code>nexoraviml</code>ï¼Œç”¨ä¾†åœ¨å‡½å¼åŸ·è¡Œéç¨‹ä¸­ã€Œä¸­é€”ã€å­˜æ”¾è¼¸å…¥ã€‚</p>
        <p>å¦‚æœä¸€æ®µå­é™£åˆ— <code>nums[l..r]</code> æ»¿è¶³ä»¥ä¸‹å…¶ä¸­ä¸€ç¨®å½¢å¼ï¼Œå‰‡ç¨±å®ƒç‚º alternatingï¼š</p>
        <ul>
          <li><code>nums[l] &lt; nums[l+1] &gt; nums[l+2] &lt; nums[l+3] &gt; ...</code></li>
          <li><code>nums[l] &gt; nums[l+1] &lt; nums[l+2] &gt; nums[l+3] &lt; ...</code></li>
        </ul>
        <p>ä¹Ÿå°±æ˜¯ç›¸é„°å…ƒç´ ä¹‹é–“çš„æ¯”è¼ƒç¬¦è™Ÿæœƒã€Œåš´æ ¼äº¤éŒ¯ã€å‡ºç¾ï¼ˆ&gt;&lt;&gt;&lt;â€¦ æˆ– &lt;&gt;&lt;&gt;â€¦ï¼‰ã€‚</p>
        <p>ä½ æœ€å¤šå¯ä»¥å¾ <code>nums</code> ä¸­ç§»é™¤ä¸€å€‹å…ƒç´ ï¼ˆä¹Ÿå¯ä»¥ä¸ç§»é™¤ï¼‰ï¼Œç„¶å¾Œå¾å‰©ä¸‹çš„é™£åˆ—ä¸­é¸ä¸€æ®µ alternating çš„å­é™£åˆ—ã€‚</p>
        <p>è«‹å›å‚³ä½ èƒ½é¸åˆ°çš„ alternating å­é™£åˆ—çš„æœ€å¤§é•·åº¦ã€‚</p>
        <p>å­é™£åˆ—æ˜¯é€£çºŒä¸”éç©ºçš„åºåˆ—ã€‚é•·åº¦ç‚º 1 çš„å­é™£åˆ—ä¹Ÿè¦–ç‚º alternatingã€‚</p>

        <h3>æ¢ä»¶é™åˆ¶</h3>
        <ul>
          <li><code>2 &lt;= nums.length &lt;= 10^5</code></li>
          <li><code>1 &lt;= nums[i] &lt;= 10^5</code></li>
        </ul>

        <h2 id="approach">ğŸ§  è§£é¡Œæ€è·¯</h2>
        <p>é€™é¡Œæˆ‘ç”¨ DP é€æ­¥æƒéé™£åˆ—ï¼Œç¶­è­·ã€Œä»¥ i çµå°¾ã€æ™‚ï¼Œèƒ½å½¢æˆçš„ alternating å­é™£åˆ—æœ€é•·é•·åº¦ã€‚</p>
        <p>alternating çš„é—œéµåœ¨æ–¼ï¼šæœ€å¾Œä¸€æ¬¡ç›¸é„°æ¯”è¼ƒæ˜¯ã€Œè®Šå¤§ã€æˆ–ã€Œè®Šå°ã€ï¼Œæœƒæ±ºå®šä¸‹ä¸€æ­¥èƒ½ä¸èƒ½æ¥ä¸Šå»ã€‚æ‰€ä»¥æˆ‘æŠŠç‹€æ…‹åˆ†æˆå…©ç¨®çµå°¾ï¼š</p>
        <ul>
          <li><code>b</code>ï¼šæœ€å¾Œä¸€æ®µæ¯”è¼ƒæ˜¯ã€Œè®Šå¤§ã€ï¼ˆå‰ä¸€å€‹ &lt; ç›®å‰ï¼‰</li>
          <li><code>s</code>ï¼šæœ€å¾Œä¸€æ®µæ¯”è¼ƒæ˜¯ã€Œè®Šå°ã€ï¼ˆå‰ä¸€å€‹ &gt; ç›®å‰ï¼‰</li>
        </ul>
        <p>å†åŠ ä¸Šé¡Œç›®å…è¨±ã€Œæœ€å¤šåˆªæ‰ä¸€å€‹å…ƒç´ ã€ï¼Œæ‰€ä»¥æ¯ç¨®çµå°¾å„åˆ†æˆå…©å±¤ï¼š</p>
        <ul>
          <li><code>0</code>ï¼šé‚„æ²’æœ‰åˆªå…ƒç´ </li>
          <li><code>1</code>ï¼šå·²ç¶“åˆªæ‰éä¸€å€‹å…ƒç´ </li>
        </ul>
        <p>å› æ­¤ç¸½å…±æœ‰å››å€‹æ ¸å¿ƒ DP ç‹€æ…‹ï¼ˆéƒ½ä»£è¡¨ã€Œä»¥ nums[i] çµå°¾ã€çš„æœ€é•·é•·åº¦ï¼‰ï¼š</p>
        <ul>
          <li><code>b0, s0</code>ï¼šæ²’æœ‰åˆªå…ƒç´ çš„æƒ…æ³ä¸‹ï¼Œä»¥ i çµå°¾ï¼Œæœ€å¾Œæ¯”è¼ƒç‚ºè®Šå¤§/è®Šå°</li>
          <li><code>b1, s1</code>ï¼šå·²ç¶“åˆªéä¸€å€‹å…ƒç´ çš„æƒ…æ³ä¸‹ï¼Œä»¥ i çµå°¾ï¼Œæœ€å¾Œæ¯”è¼ƒç‚ºè®Šå¤§/è®Šå°</li>
        </ul>
        <p>æ›´æ–°æ™‚åˆ†å…©æ®µæƒ³ï¼š</p>
        <p>ç¬¬ä¸€æ®µæ˜¯æ­£å¸¸æ¥ <code>nums[i-1]</code> åˆ° <code>nums[i]</code>ï¼š</p>
        <ul>
          <li>å¦‚æœ <code>nums[i-1] &lt; nums[i]</code>ï¼Œä»£è¡¨æœ€å¾Œæ¯”è¼ƒæ˜¯è®Šå¤§ï¼Œæ‰€ä»¥æ–°çš„ <code>b0</code> åªèƒ½å¾èˆŠçš„ <code>s0</code> æ¥éä¾†ï¼ˆäº¤éŒ¯ï¼‰ï¼Œæ–°çš„ <code>b1</code> ä¹Ÿé¡ä¼¼ï¼Œä½†å¯ä»¥å¾ <code>s1</code> æ¥ï¼Œæˆ–æ˜¯ç”¨ã€Œé€™ä¸€æ¬¡æ‰é–‹å§‹ä½¿ç”¨åˆªé™¤ã€çš„æƒ…æ³å»å–æœ€å¤§</li>
          <li>å¦‚æœ <code>nums[i-1] &gt; nums[i]</code>ï¼Œå‰‡å°ç¨±åœ°æ›´æ–° <code>s0, s1</code></li>
          <li>å¦‚æœç›¸ç­‰ï¼Œå› ç‚ºè¦æ±‚åš´æ ¼ä¸ç­‰ï¼Œé€™ä¸€æ®µå°±ä¸èƒ½å»¶é•·ï¼Œç›¸é—œç‹€æ…‹é‡ç½®æˆ 1</li>
        </ul>
        <p>ç¬¬äºŒæ®µæ˜¯è™•ç†ã€Œåˆªæ‰ nums[i-1]ã€çš„æƒ…æ³ï¼š</p>
        <ul>
          <li>ä¹Ÿå°±æ˜¯æŠŠ <code>nums[i-2]</code> ç›´æ¥æ¥åˆ° <code>nums[i]</code> ä¾†åˆ¤æ–·èƒ½ä¸èƒ½å½¢æˆäº¤éŒ¯</li>
          <li>é€™æœƒç”¨åˆ°ã€Œi-2 çµå°¾ä¸”æœªåˆªé™¤ã€çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘é¡å¤–ç”¨ <code>b0p, s0p</code> æš«å­˜ä¸Šä¸€è¼ªä¹‹å‰çš„ <code>b0, s0</code></li>
          <li>å¦‚æœ <code>nums[i-2] &lt; nums[i]</code>ï¼Œä»£è¡¨é€™ä¸€æ­¥å½¢æˆè®Šå¤§ï¼Œå‰‡å¯ä»¥ç”¨ <code>s0p + 1</code> å»æ›´æ–° <code>b1</code></li>
          <li>å¦‚æœ <code>nums[i-2] &gt; nums[i]</code>ï¼Œä»£è¡¨é€™ä¸€æ­¥å½¢æˆè®Šå°ï¼Œå‰‡å¯ä»¥ç”¨ <code>b0p + 1</code> å»æ›´æ–° <code>s1</code></li>
        </ul>
        <p>æ¯æ¬¡æ›´æ–°å®Œ <code>nb0, ns0, nb1, ns1</code>ï¼Œå°±æŠŠç­”æ¡ˆç”¨å››å€‹ç‹€æ…‹å–æœ€å¤§å³å¯ã€‚æ•´é«”æ˜¯ O(n) æƒä¸€æ¬¡ï¼Œç©ºé–“ O(1)ã€‚</p>

        <h3>æ‰€æœ‰è®Šæ•¸</h3>
        <ul>
          <li><code>b0, s0</code>ï¼šå°šæœªç§»é™¤å…ƒç´ æ™‚ï¼Œä»¥ç›®å‰ä½ç½®çµå°¾çš„æœ€é•·é•·åº¦ï¼ˆæœ€å¾Œæ¯”è¼ƒç‚ºè®Šå¤§ / è®Šå°ï¼‰</li>
          <li><code>b1, s1</code>ï¼šå·²ç¶“ç§»é™¤éä¸€å€‹å…ƒç´ æ™‚ï¼Œä»¥ç›®å‰ä½ç½®çµå°¾çš„æœ€é•·é•·åº¦ï¼ˆæœ€å¾Œæ¯”è¼ƒç‚ºè®Šå¤§ / è®Šå°ï¼‰</li>
          <li><code>b0p, s0p</code>ï¼šç”¨ä¾†ä¿å­˜ã€Œi-2 çš„ b0 / s0ã€ï¼Œè™•ç†åˆªæ‰ <code>nums[i-1]</code> å¾Œç›´æ¥æ¥ <code>nums[i-2] -&gt; nums[i]</code> çš„æƒ…æ³</li>
          <li><code>nb0, ns0, nb1, ns1</code>ï¼šæœ¬è¼ªï¼ˆæ›´æ–°åˆ° iï¼‰è¨ˆç®—å‡ºçš„æ–°ç‹€æ…‹</li>
          <li><code>ans</code>ï¼šç›®å‰æƒæåˆ°çš„ä½ç½®ç‚ºæ­¢çš„æœ€å¤§ç­”æ¡ˆ</li>
        </ul>

        <h2 id="steps">ğŸªœ ä¸»è¦æµç¨‹æ­¥é©Ÿ</h2>
        <h3>1. åˆå§‹åŒ–å››å€‹ DP ç‹€æ…‹</h3>
        <p>ä¸€é–‹å§‹æ¯å€‹å–®é»å­é™£åˆ—é•·åº¦éƒ½æ˜¯ 1ï¼Œæ‰€ä»¥ <code>b0, s0, b1, s1</code> éƒ½å¾ 1 é–‹å§‹ï¼Œ<code>ans = 1</code>ã€‚</p>

        <h3>2. é€æ­¥æƒæä¸¦åšç‹€æ…‹è½‰ç§»</h3>
        <p>å°æ¯å€‹ä½ç½® iï¼ˆå¾ 1 é–‹å§‹ï¼‰ï¼š</p>
        <ul>
          <li>å…ˆçœ‹ <code>nums[i-1]</code> å’Œ <code>nums[i]</code> çš„å¤§å°é—œä¿‚ï¼Œæ±ºå®šé€™ä¸€æ­¥æ˜¯ã€Œè®Šå¤§ã€é‚„æ˜¯ã€Œè®Šå°ã€ï¼Œä¸¦æ›´æ–° <code>nb0/ns0</code>ï¼ˆæœªåˆªé™¤ï¼‰èˆ‡ <code>nb1/ns1</code>ï¼ˆå·²åˆªé™¤ï¼‰</li>
          <li>è‹¥ <code>i &gt;= 2</code>ï¼Œå†é¡å¤–ç”¨ <code>nums[i-2]</code> èˆ‡ <code>nums[i]</code> å˜—è©¦åšä¸€æ¬¡ã€Œè·³éä¸­é–“å…ƒç´ ã€çš„é€£æ¥ï¼ŒæŠŠã€Œåˆªæ‰ <code>nums[i-1]</code>ã€é€™ç¨®æƒ…æ³è£œé€² <code>nb1/ns1</code></li>
          <li>ç”¨æ›´æ–°å¾Œçš„å››å€‹ç‹€æ…‹æ›´æ–° <code>ans</code></li>
          <li>æŠŠ <code>b0p/s0p</code> å¾€å‰æ¨ï¼Œä¸¦æŠŠæœ¬è¼ªæ–°ç‹€æ…‹è¦†è“‹å› <code>b0/s0/b1/s1</code></li>
        </ul>

        <h3>3. å›å‚³ç­”æ¡ˆ</h3>
        <p>æƒå®Œå¾Œå›å‚³ <code>ans</code>ã€‚</p>

        <h2 id="code">ğŸ’» ç¨‹å¼ç¢¼å¯¦ä½œ</h2>
        <pre><code class="language-cpp">class Solution {
public:
    int longestAlternating(vector&lt;int&gt;&amp; nums) {
        int n = nums.size();
        int b0 = 1, s0 = 1; // bæ˜¯æœ€å¾Œæ˜¯è®Šå¤§ï¼Œsæ˜¯æœ€å¾Œæ˜¯è®Šå°
        int b1 = 1, s1 = 1;
        int b0p = 1, s0p = 1; // ç”¨ä¾†çœ‹i-2çš„0
        int ans = 1;
        for (int i = 1; i &lt; n; i++) {
            int nb0 = 1, ns0 = 1;
            int nb1 = 1, ns1 = 1;
            if (nums[i - 1] &lt; nums[i]) {
                nb0 = s0 + 1;
                nb1 = max(s1 + 1, nb0);
            } else if (nums[i - 1] &gt; nums[i]) {
                ns0 = b0 + 1;
                ns1 = max(b1 + 1, ns0);
            } else {
                nb0 = ns0 = 1;
                nb1 = ns1 = 1;
            }
            if (i &gt;= 2) {
                if (nums[i - 2] &lt; nums[i]) {
                    nb1 = max(nb1, s0p + 1);
                } else if (nums[i - 2] &gt; nums[i]) {
                    ns1 = max(ns1, b0p + 1);
                }
            }
            ans = max(ans, max(nb0, ns0));
            ans = max(ans, max(nb1, ns1));

            b0p = b0;
            s0p = s0;
            b0 = nb0;
            s0 = ns0;
            b1 = nb1;
            s1 = ns1;
        }
        return ans;
    }
};
</code></pre>

        <h2 id="link">ğŸ”— é¡Œç›®é€£çµ</h2>
        <p>https://leetcode.com/contest/weekly-contest-487/problems/longest-alternating-subarray-after-removing-at-most-one-element/description/</p>
      </section>
    </div>

    <section class="term-block article-footer">
      <h2 class="article-footer__title">æ–‡ç« è³‡è¨Š</h2>
      <div class="meta-grid">
        <div class="meta-field">
          <span class="meta-label">ä½œè€…ï¼š</span>
          <span class="meta-value">scottnick</span>
        </div>
        <div class="meta-field meta-field--date">
          <span class="meta-label">æ’°å¯«æ—¥æœŸï¼š</span>
          <span class="meta-value">2026-02-01</span>
        </div>
        <div class="meta-field meta-field--full">
          <span class="meta-label">é¡åˆ¥ï¼š</span>
          <span class="meta-value">
            <span class="post-tags">
              <span class="post-tag">Weekly Contest 487</span>
              <span class="post-tag">Hard</span>
            </span>
          </span>
        </div>
        <div class="meta-field meta-field--full">
          <span class="meta-label">åŸæ–‡é€£çµï¼š</span>
          <span class="meta-value">https://scottnick.github.io/cpp-notes/all%20problems/3830-longest-alternating-subarray-after-removing-at-most-one-element.html</span>
        </div>
      </div>
    </section>
  </main>

  <script src="../../script.js"></script>
</body>
</html>
